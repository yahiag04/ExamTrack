<%- include('../partials/header', { title: 'Nuovo insegnamento - ExamTrack' }) %>

<div class="container py-4">
  <div class="row justify-content-center mb-4">
    <div class="col-lg-8">
      <div class="card shadow-sm border-0">
        <div class="card-body d-flex flex-column flex-md-row justify-content-between align-items-md-center">
          <div>
            <h1 class="h4 fw-bold mb-1">Crea nuovo insegnamento</h1>
            <p class="text-muted small mb-0">
              Inserisci un nuovo corso specificando i dati principali e il docente titolare.
            </p>
          </div>

          <a href="/amministratore/corsi" class="btn btn-sm btn-outline-secondary mt-3 mt-md-0">
            <i class="bi bi-arrow-left me-1"></i>
            Torna ai corsi
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- FORM -->
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card shadow-sm border-0">
        <div class="card-body">

          <% if (error) { %>
            <div class="alert alert-danger small"><%= error %></div>
          <% } %>

          <% if (success) { %>
            <div class="alert alert-success small"><%= success %></div>
          <% } %>

          <form method="POST" action="/amministratore/creazione_corso">
            
            <!-- Codice insegnamento -->
            <div class="mb-3">
              <label class="form-label">Codice insegnamento</label>
              <input 
                type="text" 
                name="codice_insegnamento"
                class="form-control"
                placeholder="Es. INF101"
                required
                value="<%= formData && formData.codice_insegnamento ? formData.codice_insegnamento : '' %>"
              >
              <div class="form-text small">
                Codice univoco del corso (sigla breve).
              </div>
            </div>

            <!-- Nome corso -->
            <div class="mb-3">
              <label class="form-label">Nome corso</label>
              <input 
                type="text" 
                name="nome"
                class="form-control"
                placeholder="Es. Programmazione I"
                required
                value="<%= formData && formData.nome ? formData.nome : '' %>"
              >
            </div>

            <!-- CFU -->
            <div class="mb-3">
              <label class="form-label">CFU</label>
              <input 
                type="number" 
                name="cfu"
                class="form-control"
                min="1"
                max="24"
                required
                value="<%= formData && formData.cfu ? formData.cfu : '' %>"
              >
            </div>

            <!-- Docente titolare -->
            <div class="mb-3">
              <label class="form-label">Docente titolare</label>
              <select 
                name="id_prof"
                class="form-select"
                required
              >
                <option value="">Seleziona un professore...</option>
                <% if (professori && professori.length > 0) { %>
                  <% professori.forEach(p => { %>
                    <option 
                      value="<%= p.id_prof %>"
                      <%= formData && formData.id_prof == p.id_prof ? 'selected' : '' %>
                    >
                      <%= p.nome %> <%= p.cognome %>
                    </option>
                  <% }) %>
                <% } %>
              </select>
            </div>

            <!-- Descrizione -->
            <div class="mb-4">
              <label class="form-label">Descrizione (opzionale)</label>
              <textarea 
                name="descrizione"
                class="form-control"
                rows="3"
                placeholder="Breve descrizione del corso, programma, note..."
              ><%= formData && formData.descrizione ? formData.descrizione : '' %></textarea>
            </div>

            <!-- Bottoni -->
            <div class="d-flex justify-content-between align-items-center">
              <button type="submit" class="btn btn-primary">
                <i class="bi bi-plus-circle me-1"></i>
                Crea insegnamento
              </button>

              <a href="/amministratore/corsi" class="btn btn-outline-secondary btn-sm">
                Annulla
              </a>
            </div>

          </form>

        </div>
      </div>
    </div>
  </div>

</div>

<%- include('../partials/footer') %>