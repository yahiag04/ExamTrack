<%- include('../partials/header', { title: 'Esiti da verbalizzare - ExamTrack' }) %>

<div class="container py-4">
  <div class="row justify-content-center mb-4">
    <div class="col-lg-10">
      <div class="card shadow-sm border-0">
        <div class="card-body d-flex flex-column flex-md-row justify-content-between align-items-md-center">
          <div>
            <h1 class="h4 fw-bold mb-1">Esiti da verbalizzare</h1>
            <p class="text-muted small mb-0">
              Elenco degli esami <strong>completi, superati e accettati dagli studenti</strong>,
              in attesa di verbalizzazione.
            </p>
          </div>

          <a href="/professore/dashboard" class="btn btn-sm btn-outline-secondary mt-3 mt-md-0">
            <i class="bi bi-arrow-left me-1"></i>
            Torna alla dashboard
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- MESSAGGI -->
  <div class="row justify-content-center mb-3">
    <div class="col-lg-10">
      <% if (error) { %>
        <div class="alert alert-danger small mb-2">
          <%= error %>
        </div>
      <% } %>

      <% if (success) { %>
        <div class="alert alert-success small mb-2">
          <%= success %>
        </div>
      <% } %>
    </div>
  </div>

  <!-- TABELLA -->
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <div class="card shadow-sm border-0">
        <div class="card-body">

          <% if (!votiDaVerbalizzare || votiDaVerbalizzare.length === 0) { %>
            <p class="text-muted small mb-0">
              Al momento non ci sono esami da verbalizzare.
            </p>
          <% } else { %>

            <div class="table-responsive">
              <table class="table table-sm align-middle">
                <thead class="table-light">
                  <tr>
                    <th>Studente</th>
                    <th>Matricola</th>
                    <th>Corso</th>
                    <th class="text-center">Voto</th>
                    <th class="text-center">Data esame</th>
                    <th class="text-end">Azione</th>
                  </tr>
                </thead>
                <tbody>
                  <% votiDaVerbalizzare.forEach(v => { %>
                    <tr>
                      <td>
                        <strong><%= v.nome_studente %> <%= v.cognome_studente %></strong>
                      </td>
                      <td><code><%= v.matricola %></code></td>
                      <td><%= v.nome_insegnamento %></td>
                      <td class="text-center">
                        <span class="badge bg-success-subtle text-success border border-success-subtle">
                          <%= v.voto %>/30
                        </span>
                      </td>
                      <td class="text-center">
                        <%= v.data_svolgimento.toISOString().slice(0,10) %>
                      </td>
                      <td class="text-end">
                        <form method="POST" action="/professore/verbalizzazioni/<%= v.id_tentativo %>/verbalizza" class="d-inline">
                          <button type="submit" class="btn btn-sm btn-primary">
                            <i class="bi bi-clipboard-check me-1"></i>
                            Verbalizza
                          </button>
                        </form>
                      </td>
                    </tr>
                  <% }) %>
                </tbody>
              </table>
            </div>

          <% } %>

        </div>
      </div>
    </div>
  </div>

</div>

<%- include('../partials/footer') %>